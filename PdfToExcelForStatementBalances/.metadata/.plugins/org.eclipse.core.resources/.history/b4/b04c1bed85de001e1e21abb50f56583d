package com.anastacio.PdfToExcelForStatementBalances;

import java.io.File;


/**
 * Hello world!
 *
 */
public class App {
	public static void main(String[] args) {
		
		// Obtain pdf file
		//File pdfFile = new File("C:\\Users\\anast\\Documents\\Online Accounts\\Prosperity Bank\\Account Statements\\2024 Statements\\statement_02112024.pdf");
		File pdfFile = new File("C:\\Users\\anast\\Documents\\Online Accounts\\Prosperity Bank\\Account Statements\\2018 Statements\\statement_06112018.pdf");
		String[] pdfFilePathArray = pdfFile.toString().split("\\\\");
		String pdfFileName = pdfFilePathArray[pdfFilePathArray.length - 1].toString();
		String[] pdfFileNameArray = pdfFileName.split("\.");
		System.out.println(pdfFileName);
		String newRawExcelFileName = pdfFileNameArray[0].toString() + ".xlsx";
		System.out.println(newRawExcelFileName);
		
		// Parse PDF to Text
		PdfParser pdfParser = new PdfParser();
		pdfParser.parsePdfFile(pdfFile);
		String pdfText = pdfParser.getPdfText();
		
		// Parse raw pdf text to raw excel file
		RawTextToRawExcel rawTextToRawExcel = new RawTextToRawExcel();
		File rawExcelFile =  rawTextToRawExcel.processRawTextFileToRawExcel(pdfText, pdfFileName);
		
		// Parse raw excel file
		ParseRawExcelFile parseRawExcelFile = new ParseRawExcelFile(rawExcelFile);
		
		System.out.println("Statement Date: " + parseRawExcelFile.getStatementDate());
		System.out.println("Account Number: " + parseRawExcelFile.getAccountNumber());
		
	} // end of main
}
